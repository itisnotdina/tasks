
# Сотрудники

Сервис сотрудников – это Web API приложение, которое хранит данные сотрудников, доступные для чтения и редактирования, а также позволяет  работать с реквизитами сотрудников организации другим сервисам.

В основном данные сотрудников нужны для указания в [Реквизитах плательщика](https://support.kontur.ru/extern/39033-rekvizity_platelshhika), которые используются в отчете пользователя.

<!---
только ли для этого нужен сервис? может быть сотрудники подтягиваются где-то еще?
--->

### Преимущества сервиса
---

**Раньше** данные сотрудников хранились для каждой организации отдельно. Если сотрудник относился к нескольким организациям, его данные дублировались. Это приводило к следующим трудностям:

- При необходимости поменять данные о сотруднике, пользователю нужно было их менять для всех организаций, к которым относился сотрудник.
- При работе нескольких пользователей с одной организацией, каждому пользователю приходилось вводить одни и те же реквизиты.
- При работе пользователей в нескольких продуктах, они должны были вводить реквизиты организации в обоих сервисах. Изменение реквизитов в одном сервисе не меняло данные реквизитов в другом сервисе.

<!---
3 пункт я не совсем понимаю. реквизиты одной организации правятся в сервисе организаций и для каждого сотрудника? или как?
--->

**Сейчас** данные о сотрудниках хранятся в одно месте и закреплены за определенными пользователям. Сущности не доступны другим пользователям, они доступны только для организаций ответственного пользователя. Их также можно использовать для формирования отчетов и Сообщения о представительстве.

### Сущности сервиса
---

#### Сотрудник (Person, Employee)

Человек, работающий в конкретной организации.

**Ключ**: GUID

**Таблица с данными**: employee.persons

| Поле                                  | Тип      |
| ------------------------------------- | -------- |
| FullName/Полное имя                   |          |
| InnFl/ИНН                             | String   |
| BirthDate/Дата рождения               | Datetime |
| Gender/Пол                            |          |
| Citizenship/Гражданство               | String   |
| BirthPlace,Место рождения             | String   |
| Phone/Телефон                         | String   |
| Email/Электронная почта               | String   |
| RegistrationAddress/Адрес регистрации |          |
| IdentityCard/Паспорт                  |          |
| ForeignAddress/Зарубежный адрес       | String   |

<!---
а какие типы данных у полей с пропусками?
--->

#### Должность (Position)

Данные о сотруднике и его положение в конкретной организации.

**Ключ**: GUID сотрудника + GUID организации

**Значение**: документ, в котором есть только название должности сотрудника в организации. Сотрудник может иметь только одну должность внутри организации.

**Таблица с данными**: employee.positions

| Поле           | Тип    | Описание            |
| -------------- | ------ | ------------------- |
| Title/Название | String | Название должности. |


#### Роль (Role)

Данные о том, какую задачу в организации выполняет сотрудник с должностью. Это соотношение связи сотрудник-организация к связи организация-тип_роли.

Существует 4 типа роли: 

- Руководитель
- Главный бухгалтер
- Уполномоченный представитель (отправитель)
- Индивидуальный предприниматель (ИП)

**Ключ**: GUID организации + Тип роли

**Значение**: документ, в котором есть сотрудник с определенной ролью в организации. Сотрудник может быть также из другой (например, материнской) организации.

**Таблица с данными**: employee.roles

| Поле                                        | Тип  | Описание                                   |
| ------------------------------------------- | ---- | ------------------------------------------ |
| Person/Сотрудник                            | GUID | Сотрудник с ролью в организации.           |
| PositionOrganization/Организация сотрудника | GUID | Организация, в которой работает сотрудник. |

### Взаимодействие с сервисом
---

С сервисом сотрудников можно взаимодействовать через клиент и REST API. Доступные методы:

#### AddPerson(Guid user, PersonProps person);

Используйте метод для создания сотрудника. Этот метод идемпотентный, то есть изменяет состояние сущностей в БД только при первом запросе.

В URL вместо POST-запроса `/person`, делается PUT-запрос `/person/{PersonId}`.

<!---
что возвращает метод? объект, код ответа?
--->

#### DeletePerson(Guid user, Guid personGuid);

Используйте этот метод для удаления сущности сотрудника.

<!---
что возвращает метод? код ответа? или вообще не возвращает ответа?
--->

#### SearchPersons(Guid user, IFilter filter, int? skip = null, int? take = null, IEnumerable<string> fieldsToInclude = null);

Используйте метод для получения списка сотрудников по определенным заданным условиям.

<!---
что возвращает метод? выборку сущностей в виде массива объектов? или код ответа?
--->

#### DeleteRole(Guid user, Guid organization, RoleType roleType);

Используйте метод для удаления роли. 

#### DeleteRoles(Guid user, Guid organization);

Используйте метод для удаления всех ролей.

<!---
что возвращает метод? код ответа? или вообще не возвращает ответа?
--->
